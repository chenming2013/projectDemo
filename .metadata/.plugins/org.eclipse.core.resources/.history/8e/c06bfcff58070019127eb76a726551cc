package com.chenming.algorithm;

import java.security.InvalidKeyException;
import java.security.NoSuchAlgorithmException;

import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import javax.xml.bind.annotation.adapters.HexBinaryAdapter;

import org.junit.Test;

/**
 * 测试MAC加密算法
 * 	MAC加密算法是单向的,是基于散列函数
 * @author 陈明
 * @date 2018年12月24日
 */
public class MACTest {

	/**
	 * HmacMD5摘要算法(手动指定秘钥)
	 * 对于给定生成的不同秘钥,得到的摘要信息不同,所以在实际应用中,要保存我们的秘钥
	 * @throws NoSuchAlgorithmException 
	 * @throws InvalidKeyException 
	 */
	@Test
	public void testHmacMD5() throws NoSuchAlgorithmException, InvalidKeyException {
		
		//要加密的消息
		String str = "这是要加密的消息";
		//秘钥
		byte[] key = "cm".getBytes();
		
		SecretKeySpec secretKeySpec = new SecretKeySpec(key, "HmacMD5");
		
		//实例化Mac
		Mac mac = Mac.getInstance(secretKeySpec.getAlgorithm());
		
		//初始化Mac
		mac.init(secretKeySpec);
		
		//执行消息摘要
		byte[] digest = mac.doFinal(str.getBytes());
		
		System.out.println(new HexBinaryAdapter().marshal(digest));		//04CCEA27E8F571E3AF478E8F8B3CCA71
	}
	
	
	/**
	 * HmacMD5摘要算法(自动生成秘钥)
	 * 对于给定生成的不同秘钥,得到的摘要信息不同,所以在实际应用中,要保存我们的秘钥
	 */
	@Test
	public void testHmacMD5() {
		
	}
	
	
	
	
	
	
	@Test
	public void test() {
		System.out.println("04CCEA27E8F571E3AF478E8F8B3CCA71".length());
	}
	
	
	
	
}
