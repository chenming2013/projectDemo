package com.chenming.poi.POIOperate_01_basic;

import java.io.File;
import java.io.IOException;

import org.apache.poi.EncryptedDocumentException;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import org.apache.poi.poifs.filesystem.NPOIFSFileSystem;
import org.apache.poi.poifs.filesystem.POIFSFileSystem;
import org.apache.poi.ss.usermodel.Workbook;
import org.apache.poi.ss.usermodel.WorkbookFactory;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.junit.Test;

import junit.framework.TestCase;

/**
 * 这个类是测试打开Excel(Workbook对象)的操作
 * 打开已有的Excel,有三种方式：使用WorkbookFactory、POIFSFi了System以及new的方式,并且Excel也有两种格式
 * 本类主要是测试用POIFSFileSystem打开已有的Excel
 * @author 陈明
 * @date   2018年8月5日
 */
public class Basic_01_ExcelOpenTest_2 extends TestCase
{
	/**
	 * 有下面的测试可知,POIFSFileSystem只能打开 .xls 格式的Excel文件,并不能打开 .xlsx 格式的Excel文件
	 */
	
	
	/**
	 * 打开已有Excel的三种方式之一：
	 * 测试用POIFSFileSystem对象打开已有的Excel
	 * 	这个方法是通用 .xls 和 .xlsx 格式的Excel文件
	 * @throws IOException 
	 */
	@Test
	public void testOpenExcelForCommonUsingPFS() throws IOException {
		File file1 = new File("F:\\GitReponsitory\\Note\\Note\\后端\\知识点\\POI\\知识点\\POI测试文件夹\\read\\1.xls");
		POIFSFileSystem pfs1 = new POIFSFileSystem(file1);
		Workbook wb1 = WorkbookFactory.create(pfs1);
		System.out.println(wb1);  //org.apache.poi.hssf.usermodel.HSSFWorkbook@63753b6d
		System.out.println(wb1.getClass());  //class org.apache.poi.hssf.usermodel.HSSFWorkbook
		
		/**
		 * 下面的操作报错
		 */
//		File file2 = new File("F:\\GitReponsitory\\Note\\Note\\后端\\知识点\\POI\\知识点\\POI测试文件夹\\read\\1.xlsx");
//		NPOIFSFileSystem pfs2 = new NPOIFSFileSystem(file2);
		
	}
	
	
	/**
	 * 打开已有Excel的三种方式之一：
	 * 测试用POIFSFileSystem对象打开已有的Excel
	 * 	这个方法是专门打开 .xls 格式的Excel文件
	 * @throws IOException 
	 */
	@Test
	public void testOpenExcelFOrXLSUsingPFS() throws IOException {
		File file1 = new File("F:\\GitReponsitory\\Note\\Note\\后端\\知识点\\POI\\知识点\\POI测试文件夹\\read\\1.xls");
		POIFSFileSystem pfs1 = new POIFSFileSystem(file1);
		HSSFWorkbook hwb1 = (HSSFWorkbook)WorkbookFactory.create(pfs1);
		System.out.println(hwb1);  //org.apache.poi.hssf.usermodel.HSSFWorkbook@63753b6d
		System.out.println(hwb1.getClass());  //class org.apache.poi.hssf.usermodel.HSSFWorkbook
	}
}
