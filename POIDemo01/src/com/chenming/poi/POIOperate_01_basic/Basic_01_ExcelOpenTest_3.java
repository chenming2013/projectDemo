package com.chenming.poi.POIOperate_01_basic;

import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;

import org.apache.poi.hssf.usermodel.HSSFWorkbook;
import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.junit.Test;

import junit.framework.TestCase;

/**
 * 这个类是测试打开Excel(Workbook对象)的操作
 * 打开已有的Excel,有三种方式：使用WorkbookFactory、POIFSFi了System以及new的方式,并且Excel也有两种格式
 * 本类主要是测试用new的方式打开已有的Excel
 * @author 陈明
 * @date   2018年8月5日
 */
public class Basic_01_ExcelOpenTest_3 extends TestCase
{
	
	/**
	 * 打开已有Excel的三种方式之一：
	 * 测试用new对象的方式打开已有的Excel
	 * 	这个方法是专门打开 .xls 格式的Excel文件
	 * @throws IOException 
	 */
	@Test
	public void testOpenExcelForXLSUsingNew() throws IOException {
		File file1 = new File("F:\\GitReponsitory\\Note\\Note\\后端\\知识点\\POI\\知识点\\POI测试文件夹\\read\\1.xls");
		InputStream in = new FileInputStream(file1);
		HSSFWorkbook hwb = new HSSFWorkbook(in);
		System.out.println(hwb.getNumberOfSheets());  //3
	}
	
	/**
	 * 打开已有Excel的三种方式之一：
	 * 测试用new对象的方式打开已有的Excel
	 * 	这个方法是专门打开 .xlsx 格式的Excel文件
	 * @throws IOException 
	 * @throws InvalidFormatException 
	 */
	@Test
	public void testOpenExcelForXLSXUsingNew() throws InvalidFormatException, IOException {
		File file2 = new File("F:\\GitReponsitory\\Note\\Note\\后端\\知识点\\POI\\知识点\\POI测试文件夹\\read\\1.xlsx");
		XSSFWorkbook xwb = new XSSFWorkbook(file2);
		System.out.println(xwb.getNumberOfSheets());  //3
	}
}
